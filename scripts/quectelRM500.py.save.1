
from attila.atre import ATRuntimeEnvironment
from attila.exceptions import ATREUninitializedError, ATRuntimeError, ATScriptNotFound, ATScriptSyntaxError, ATSerialPortError

# Configuration
device = '/dev/ttyUSB2'
baud_rate = 115200
timeout = 2
line_break = '\r\n'
command = 'AT+CFUN=0'

# Create ATRuntimeEnvironment object
atrunenv = ATRuntimeEnvironment(True)

# Configure communicator
atrunenv.configure_communicator(device, baud_rate, timeout, line_break)

# Open serial port
atrunenv.open_serial()

# Add command to the session
atrunenv.add_command(command)

# Execute commands
try:
    response_list = atrunenv.run()
    for response in response_list:
        print(response)
except ATRuntimeError as e:
    print("Command failed with error:", e)

# Close serial port
atrunenv.close_serial()
